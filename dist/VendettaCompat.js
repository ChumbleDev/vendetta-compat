const{native}=window.enmity;function reload(){native.reload()}native.version,native.build,native.device,native.version;function set(e,o,t){window.enmity.settings.set(e,o,t)}function get(e,o,t){return window.enmity.settings.get(e,o,t)}function registerPlugin(e){window.enmity.plugins.registerPlugin(e)}const Constants=window.enmity.modules.common.Constants;window.enmity.modules.common.Clipboard,window.enmity.modules.common.Assets,window.enmity.modules.common.Messages,window.enmity.modules.common.Clyde,window.enmity.modules.common.Avatars,window.enmity.modules.common.Native;const React=window.enmity.modules.common.React;window.enmity.modules.common.Dispatcher,window.enmity.modules.common.Storage;const Toasts=window.enmity.modules.common.Toasts,Dialog=window.enmity.modules.common.Dialog;window.enmity.modules.common.Token,window.enmity.modules.common.REST,window.enmity.modules.common.Settings,window.enmity.modules.common.Users,window.enmity.modules.common.Navigation,window.enmity.modules.common.NavigationNative,window.enmity.modules.common.NavigationStack,window.enmity.modules.common.Theme,window.enmity.modules.common.Linking;const StyleSheet=window.enmity.modules.common.StyleSheet;window.enmity.modules.common.ColorMap,window.enmity.modules.common.Components,window.enmity.modules.common.Locale,window.enmity.modules.common.Profiles,window.enmity.modules.common.Lodash,window.enmity.modules.common.Logger,window.enmity.modules.common.Flux,window.enmity.modules.common.SVG,window.enmity.modules.common.Scenes,window.enmity.modules.common.Moment;var name="VendettaCompat",version="1.2.0",description="Use Bunny/Vendetta plugins inside Enmity",authors=[{name:"Rosie<3",id:"581573474296791211"},{name:"SerStars",id:"861631850681729045"}],color="#FFFFFF",Manifest={name,version,description,authors,color};const{components}=window.enmity;components.Alert,components.Button,components.FlatList,components.Image,components.ImageBackground,components.KeyboardAvoidingView,components.Modal,components.Pressable,components.RefreshControl,components.ScrollView,components.SectionList,components.StatusBar,components.StyleSheet,components.Switch,components.Text,components.TextInput,components.TouchableHighlight,components.TouchableOpacity,components.TouchableWithoutFeedback,components.Touchable,components.View,components.VirtualizedList,components.Form,components.FormArrow,components.FormCTA,components.FormCTAButton,components.FormCardSection,components.FormCheckbox;const FormDivider=components.FormDivider;components.FormHint,components.FormIcon;const FormInput=components.FormInput;components.FormLabel,components.FormRadio;const FormRow=components.FormRow,FormSection=components.FormSection;components.FormSelect,components.FormSubLabel;const FormSwitch=components.FormSwitch;components.FormTernaryCheckBox;const FormText=components.FormText;components.FormTextColors,components.FormTextSizes;function getIDByName(e){return window.enmity.assets.getIDByName(e)}var Settings=({Manifest:e})=>{const[o,t]=React.useState(get(e.name,"customBunnyURL",{enabled:!1,url:"http://localhost:4040/Bunny.js"})),m=StyleSheet.createThemedStyleSheet({icon:{color:Constants.ThemeColorMap.INTERACTIVE_NORMAL},info:{color:StyleSheet.ThemeColorMap.HEADER_PRIMARY,fontFamily:Constants.Fonts.DISPLAY_BOLD,textAlign:"center",fontSize:14,marginTop:10}});return React.createElement(React.Fragment,null,React.createElement(FormSection,{title:"Settings"},React.createElement(FormRow,{label:"Custom Bunny URL",subLabel:"Load Bunny from a custom url",leading:React.createElement(FormRow.Icon,{style:m.icon,source:getIDByName("ic_link_24px")}),trailing:React.createElement(FormSwitch,{value:o.enabled,onValueChange:()=>t(n=>(set(e.name,"customBnURL",{enabled:!0,url:n.url}),{enabled:!0,url:n.url}))})}),o.enabled&&React.createElement(FormInput,{value:o.url,onChangeText:n=>t(s=>(set(e.name,"customBunnyURL",{enabled:s.enabled,url:n}),{enabled:s.enabled,url:n})),placeholder:"http://localhost:4040/Bunny.js",title:"Bunny URL"})),React.createElement(FormDivider,null),React.createElement(FormSection,{title:"Clear Stores"},React.createElement(FormRow,{label:"Clear Stores",subLabel:"Clear enable dialog and cached code.",leading:React.createElement(FormRow.Icon,{style:m.icon,source:getIDByName("ic_message_delete")}),trailing:()=>React.createElement(FormRow.Arrow,null),onPress:()=>{set(e.name,"shownEnabledDialog",!1),Toasts.open({content:"Successfully cleared all stored data.",source:getIDByName("ic_check_18px")})}})),React.createElement(FormDivider,null),React.createElement(FormSection,{title:"Reload"},React.createElement(FormRow,{label:"Reload",subLabel:"Reload Discord to apply any changes.",leading:React.createElement(FormRow.Icon,{style:m.icon,source:getIDByName("ic_message_retry")}),trailing:()=>React.createElement(FormRow.Arrow,null),onPress:()=>reload()})),React.createElement(FormDivider,null),React.createElement(FormText,null,"Version ",e.version," by ",e.authors.map(n=>n.name).join(", ")))};const VendettaCompat={...Manifest,async onStart(){const showSuccessDialog=()=>{get(Manifest.name,"shownEnabledDialog",!1)||Dialog.show({title:"Enabled Bunny",body:"Successfully enabled Bunny. To disable it, just disable the plugin.",confirmText:"Okay",onConfirm:()=>set(Manifest.name,"shownEnabledDialog",!0)})},customBunnyURL=get(Manifest.name,"customBunnyURL"),url=customBunnyURL!=null&&customBunnyURL.enabled?customBunnyURL.url:"https://raw.githubusercontent.com/bunny-mod/builds/main/bunny.js",res=await fetch(url),bunnyCode=res.ok?await res.text():get(Manifest.name,"bunnyCode",null);set(Manifest.name,"bunnyCode",bunnyCode),eval(bunnyCode),showSuccessDialog()},onStop(){const e=window.bunny;if(e)try{e==null||e.unload(),Dialog.show({title:"Must Reload",body:"To fully disable Bunny, you need to reload your Discord. Please note that Bunny will not work until you reload Discord.",confirmText:"Reload",cancelText:"Later",onConfirm:()=>reload()})}catch(o){console.error(`[${Manifest.name}] Error when trying to unload Bunny: ${o}`)}},getSettingsPanel(){return React.createElement(Settings,{Manifest})}};registerPlugin(VendettaCompat);
